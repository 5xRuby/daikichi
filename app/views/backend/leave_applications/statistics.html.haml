%h2= t("captions.backend/leave_applications.statistics", year: specific_year, month: specific_month)

.panel.panel-default
  .panel-heading= t('panel_header.filter_conditions')
  .panel-body
    = simple_form_for @q, url: url_for(action: :statistics), method: :get do |f|
      = f.hidden_field :s, value: params.dig(:q, :s)
      = f.input :leave_type_eq, collection: LeaveApplication.enum_attributes_for_select(:leave_types),
        include_blank: t('.plz_select_leave_type'), required: false, wrapper_html: { class: 'col-md-6' }
      = f.input :user_id_eq, collection: @users, required: false,
        include_blank: t('.plz_select_user'), label_method: :name, value_method: :id,
        wrapper_html: { class: 'col-md-6' }
      = f.input :end_date_gteq, wrapper_html: { class: 'date-input col-md-6' },
        input_html: { data: { input: 'datepicker', format: 'Y/m/d' } }, required: false
      = f.input :start_date_lteq, wrapper_html: { class: 'date-input col-md-6' },
        input_html: { data: { input: 'datepicker', format: 'Y/m/d' } }, required: false

      .text-right
        = f.button :submit, class: 'btn-warning'

- if current_collection.any?
  %table.table.table-striped.table-bordered.table-hover
    %thead
      %tr.info
        %th.text-right
          = sort_link(@q, :id, '#')
        %th.text-center= t_attribute :user, LeaveApplication
        %th.text-center= t_attribute :leave_type, LeaveApplication
        %th.text-right
          = sort_link(@q, :start_time)
        %th.text-right
          = sort_link(@q, :end_time)
        %th.text-right
          = sort_link(@q, :hours)

    %tbody
      - current_collection.each do |leave|
        %tr
          %td.text-right= link_to leave.id, verify_backend_leave_application_path(leave.id)
          %td.text-center= t_value :user, leave, :convert_user_object_to_name, :name
          %td.text-center= LeaveApplication.human_enum_value(:leave_type, leave.leave_type)
          %td.text-right= l leave.start_time, format: :long
          %td.text-right= l leave.end_time, format: :long
          %td.text-right= hours_to_humanize(leave.hours)
 
    %tfoot
      %tr
        %th.text-right{colspan: 5} Sum
        %td.active.text-right= hours_to_humanize current_collection.to_a.sum(&:hours)
- else
  = no_data_alert

.paginate
  = paginate current_collection

